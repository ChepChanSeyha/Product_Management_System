package connections;

import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.Statement;

import javax.swing.table.DefaultTableModel;

import classes.Product;
import classes.Staff;

public class ProductDatabase extends Connections{

	public ProductDatabase() {
		super();
		// TODO Auto-generated constructor stub
	}
		
	public void getAllStaff(DefaultTableModel model) {
		try {
			String[] row= new String[7];
			String query= "SELECT * FROM product";
			Statement statement= super.getConnection().createStatement();
			ResultSet results= statement.executeQuery(query);
			while(results.next()) {
				row[0]= results.getInt(1)+"";
				row[1]= results.getString(1);
				row[2]= results.getString(2);
				row[3]= results.getString(3);
				row[4]= results.getDouble(4)+"";
				row[5]= results.getDouble(5)+"";
				
				model.addRow(row);
			}
		} catch (Exception e) {
			System.out.println(e);
		}
	}
	
	public Product getProductById(int id) {
		Product product= null;
		try {
			String query= "SELECT * FROM staff WHERE ProductId = ?";
			PreparedStatement pStatement= super.getConnection().prepareStatement(query);
			pStatement.setInt(1, id);
			ResultSet results= pStatement.executeQuery();
			while(results.next()) {
				int pid= results.getInt(1);
				String name= results.getString(2);
				String sup= results.getString(3);
				double sale= results.getDouble(4);
				double buy= results.getDouble(5);
				String stock= results.getString(6);
				
				product= new Product (pid, name, sup, sale, buy, stock);		
			}
		} catch (Exception e) {
			System.out.println(e);
		}
		return product;
	}
	
	public int createStaff(Staff staff) {
		int effectedRow=0;
		try {
			String query= "INSERT INTO staff(Name,Sex,Position,Contact,Address,Salary,Password) VALUES(?,?,?,?,?,?,?)";
			PreparedStatement pStatement= super.getConnection().prepareStatement(query);
			pStatement.setString(1, staff.getName());
			pStatement.setString(2, staff.getSex());
			pStatement.setString(3, staff.getPosition());
			pStatement.setString(4, staff.getContact());
			pStatement.setString(5, staff.getAddress());
			pStatement.setDouble(6, staff.getSalary());
			pStatement.setString(7, staff.getPassword());
			
			effectedRow=pStatement.executeUpdate();
			
		} catch (Exception e) {
			System.out.println(e);
		}
		return effectedRow;
	}
	
	public int updateStaff(Staff staff) {
		int effectedRow=0;
		try {
			String query= "UPDATE staff SET Name = ?,Sex = ?, Position = ?, Contact = ?,Address = ?, Salary = ? WHERE StaffId = ?";
			PreparedStatement pStatement= super.getConnection().prepareStatement(query);
			pStatement.setString(1, staff.getName());
			pStatement.setString(2, staff.getSex());
			pStatement.setString(3, staff.getPosition());
			pStatement.setString(4, staff.getContact());
			pStatement.setString(5, staff.getAddress());
			pStatement.setDouble(6, staff.getSalary());
			pStatement.setInt(7, staff.getSid());
			
			effectedRow= pStatement.executeUpdate();
			
		} catch (Exception e) {
			System.out.println(e);
		}
		return effectedRow;
	}
	
	public int deleteStaff(int id) {
		int effectedRow=0;
		try {
			String query= "DELETE FROM staff WHERE StaffId LIKE ?";
			PreparedStatement pStatement=super.getConnection().prepareStatement(query);
			pStatement.setInt(1, id);
			
			effectedRow= pStatement.executeUpdate();
		} catch (Exception e) {
			System.out.println(e);
		}
		
		
		return effectedRow;
	}

	public int createProduct(Product productCreate) {
		// TODO Auto-generated method stub
		return 0;
	}
}
