package product;

import java.util.ArrayList;
import java.util.List;

import connection.Connections;

import java.sql.*;

public class CRUD_Product {

	Connections ConnectDB = new Connections();
	
	public List<Product> findAll() {
		try {
			List<Product> listproducts = new ArrayList<Product>();
			PreparedStatement ps = ConnectDB.getConnection().prepareStatement("select * from product");
			ResultSet rs = ps.executeQuery();
			while (rs.next()) {
				Product p = new Product();
				p.setId(rs.getInt("ID"));
				p.setName(rs.getString("Name"));
				p.setSupplier(rs.getString("Supplier"));
				p.setSale(rs.getDouble("Sale"));
				p.setBuy(rs.getDouble("Buy"));
				p.setStock(rs.getString("Stock"));
				listproducts.add(p);
			}
			return listproducts;
		} catch (Exception e) {
			return null;
		}
		
	}
	
	public Product find(int id) {
		try {
			Product p = new Product();
			PreparedStatement ps = ConnectDB.getConnection().prepareStatement("select * from product where id = ?");
			ps.setInt(1, id);
			ResultSet rs = ps.executeQuery();
			while (rs.next()) {
				p.setId(rs.getInt("ID"));
				p.setName(rs.getString("Name"));
				p.setSupplier(rs.getString("Supplier"));
				p.setSale(rs.getDouble("Sale"));
				p.setBuy(rs.getDouble("Buy"));
				p.setStock(rs.getString("Stock"));
			}
			return p;
		} catch (Exception e) {
			return null;
		}
		
	}
	
	public boolean create (Product p) {
		try {
			PreparedStatement ps = ConnectDB.getConnection().prepareStatement("insert into product values(?,?,?,?,?)");
			ps.setString(1, p.getName());
			ps.setString(2, p.getSupplier());
			ps.setDouble(3, p.getSale());
			ps.setDouble(4, p.getBuy());
			ps.setString(5, p.getStock());
			return ps.executeUpdate() > 0;
		} catch (Exception e) {
			return false;
		}
	}

	public boolean edit (Product p) {
		try {
			PreparedStatement ps = ConnectDB.getConnection().prepareStatement("update product set Name=?, Spplier=?, Sale=?, Buy=?, Stock=? where ID=?");
			ps.setString(1, p.getName());
			ps.setString(2, p.getSupplier());
			ps.setDouble(3, p.getSale());
			ps.setDouble(4, p.getBuy());
			ps.setString(5, p.getStock());
			ps.setInt(6, p.getId());
			return ps.executeUpdate() > 0;
		} catch (Exception e) {
			return false;
		}
	}
	
	public boolean delete (Product p) {
		try {
			PreparedStatement ps = ConnectDB.getConnection().prepareStatement("delete from product where ID=? ");
			ps.setInt(1, p.getId());
			return ps.executeUpdate() > 0;
		} catch (Exception e) {
			return false;
		}
	}
}
